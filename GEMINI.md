# Gemini 开发规范 - QuickCaptureRAG 项目

这是你在 **QuickCaptureRAG** 项目中的专属开发规范。在执行任何编码、修改或文档任务之前，你必须严格遵守以下所有准则。

## 1. 核心开发原则 (Core Principles)

这是你所有行动的最高准则，必须无条件遵守。

1.  **最小成本开发 (Minimum Cost Development)**:
    *   **你的首要任务** 是使用项目已选定的开源技术栈（Tauri, Python, Ollama, LlamaIndex, ChromaDB）来解决问题。
    *   **禁止** 引入任何需要额外成本或复杂配置的商业软件或云服务，除非得到明确指示。
    *   **始终** 寻求最直接、最高效的实现路径，避免过度工程化。

2.  **隐私第一 (Privacy First)**:
    *   **你必须确保** 你编写的所有代码都坚持数据本地化原则。
    *   **严禁** 编写任何会将用户截图、文本内容或元数据上传到任何外部服务器的代码。
    *   所有的数据处理和存储都必须在用户的本地机器上完成。

3.  **文档驱动 (Documentation Driven)**:
    *   **行动准则：先查后写**。在你创建任何新文档之前，**必须** 首先使用 `list_directory` 和 `read_file` 工具检查 `docs/` 目录，确认是否已有相关文档可以更新。
    *   当你接到一个新功能或重大修改的任务时，你的工作流程**必须**包含文档环节。如果相关文档存在，你要先提出如何更新它；如果不存在，你要先创建一个简要的实现说明或设计文档。

4.  **测试保障 (Test-Guaranteed)**:
    *   对于任何核心功能的代码实现（特别是 Python 后端的 API 和数据处理逻辑），你**必须**同时编写或更新相应的测试脚本。
    *   在提交代码或完成任务前，你应主动提出运行相关的测试，以验证你的变更没有破坏现有功能。

## 2. 架构与技术栈参考

你在工作时，必须时刻记住本项目的技术架构。

*   **整体架构**: 客户端-服务端 (C/S) 架构，完全本地运行。
*   **客户端 (Client)**:
    *   **框架**: Tauri (使用 Rust 后端)
    *   **前端**: React (使用 TypeScript)
    *   **你的任务**: 负责 UI 界面、系统交互（快捷键、截图）。
*   **服务端 (Server)**:
    *   **框架**: Python + FastAPI
    *   **核心库**: LlamaIndex, ChromaDB, Ollama, Celery
    *   **你的任务**: 负责 AI 处理、数据索引、文件监控和提供本地 API。

## 3. 你的开发工作流

当你接收到一个开发任务时，或者在每次互动开始时，必须遵循以下**自动化**的、**任务驱动**的步骤：

1.  **识别当前任务**:
    *   **第一步**: 使用 `glob` 工具查找 `todo/` 目录下的最新 markdown 文件 (`todo/*.md`)。
    *   **第二步**: 读取这个最新的 `todo` 文件内容。
    *   **第三步**: 从文件顶部开始，定位到**第一个未完成**的任务项（即以 `- [ ]` 开头的行）。这将是你当前唯一需要关注的任务。

2.  **执行单个任务**:
    *   **文档检查**: 检查 `docs/` 目录，寻找与当前任务相关的设计或说明文档。
    *   **文档操作**: 如果文档需要更新或创建，请先完成此项。
    *   **测试先行**: 在计划中明确你将为任务编写的测试。
    *   **编码实现**: 编写代码以完成任务。

3.  **同步开发进度**:
    *   **任务完成**: 当你完成了当前的任务项后（例如，完成了 `1.1: 初始化 Tauri 项目`），你**必须**立即更新 `todo` 文件。
    *   **更新方式**: 将对应的行从 `- [ ]` 修改为 `- [x]`。
    *   **报告进度**: 向用户报告你刚刚完成的任务，并告知下一个要开始的任务。

4.  **循环**: 重复以上步骤，直到 `todo` 文件中的所有任务都完成。

## 4. 项目代码约定

你生成的所有代码都必须符合以下规范：

*   **代码风格**:
    *   **Python**: 使用 `Black` 格式化, `Ruff` 检查。
    *   **TypeScript/React**: 使用 `Prettier` 和 `ESLint`。
*   **命名约定**:
    *   **Python**: 文件和变量/函数使用 `snake_case`。
    *   **TypeScript/React**: 文件名使用 `kebab-case`，变量/函数使用 `camelCase`，组件使用 `PascalCase`。
*   **Commit 消息**:
    *   **必须** 遵循 **Conventional Commits** 规范。
    *   **格式**: `<type>(<scope>): <subject>`
    *   **示例**: `feat(api): add endpoint for user query` 或 `docs(readme): update setup instructions`

## 5. 特别说明

*   **依赖 Ollama**: 你必须清楚，本项目的 AI 功能依赖于用户本地安装和运行的 `Ollama`。在相关文档或说明中，需要清晰地指引用户如何安装和拉取所需模型（如 LLaVA, Llama 3）。
*   **环境变量**: 你不能直接在代码中硬编码任何路径或密钥。所有配置项都应通过 `.env` 文件加载。在需要时，你应该更新 `.env.example` 文件。
